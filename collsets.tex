\documentclass{patmorin}
%\usepackage[top=0.85in, bottom=0.85in, left=0.85in, right=0.85in]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{graphicx}
%\usepackage{xspace}
%\usepackage{wrapfig}
\newcommand{\Vspace}[1]{}
\usepackage{enumerate}
\usepackage{cite}
\usepackage{pat}
\usepackage{paralist}
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=linkblue,  anchorcolor=linkblue,
citecolor=linkblue, filecolor=linkblue, menucolor=linkblue,
urlcolor=linkblue, pdfcreator=Me, pdfproducer=Me} 
\setlength{\parskip}{1ex}
\usepackage{algorithm}
\usepackage{subfig}
\usepackage{array}
\usepackage[noend]{algpseudocode}
\usepackage[usenames]{xcolor}
\usepackage{stmaryrd} % for lightning-symbol
\usepackage{mathtools} % for mathclap in \conf-definition
\usepackage{todonotes}
%\usepackage{compress}
%\usepackage{times}
\usepackage{lineno}

\title{\MakeUppercase{Dual Circumference and Collinear Sets}%
    \thanks{This work was partly funded by NSERC and MRI.}}

\author{Vida Dujmovi\'c\thanks{Department of Computer Science and Electrical Engineering, University of Ottawa}\,\, and 
        Pat Morin\thanks{School of Computer Science, Carleton University}}

\newcommand{\dual}[1]{{#1}^\star}
\newcommand{\note}[2]{{\color{red}#1:~#2}}

\begin{document}
\maketitle


\begin{abstract}
   We show that, if a $n$-vertex triangulation $T$ of maximum degree
   $\Delta$ has a dual that contains a cycle of length $\ell$, then
   $T$ has a plane straight-line drawing in which some \emph{collinear
   set} of $\Omega(\ell/\Delta^2)$ vertices lie on a line.  Using the
   current lower bounds on the length of longest cycles in 3-regular
   3-connected graphs, this implies that $T$ has a collinear set of
   size $\Omega(n^{0.8}/\Delta^2)$.  Such collinear sets have numerous
   applications in graph drawing and related areas.
\end{abstract}

\section{Introduction}

For a planar graph $G$, we say that a set $S\subseteq V(G)$ is
a \emph{collinear set} if $G$ has a non-crossing straight-line drawing in
which the vertices of $S$ are all collinear.  The \emph{dual} $\dual{G}$
of a plane graph $G$ is the graph whose vertex set $V(\dual{G})$ is
the set of faces in $G$ and in which $f,g\in E(\dual{G})$ if and only
if the face $f$ and the face $g$ have at least one edge in common.
The \emph{circumference}, $c(G)$ of a graph $G$ is the length of its
longest cycle. We prove the following theorem:

\begin{thm}\thmlabel{main}
  Let $T$ be a triangulation of maximum degree $\Delta$ whose dual
  $\dual{T}$ has circumference $\ell$. Then $T$ has a collinear set of
  size $\Omega(\ell/\Delta^2)$.
\end{thm}

The dual of a triangulation is a 3-connected cubic planar graph.
The study of the circumference of 3-connected cubic planar graphs
has a long and rich history going back at least 1884 when Tait
\cite{tait:listings},conjectured that every such graph is Hamiltonian.  In
1946, Tait's conjecture was disproved by Tutte who gave a non-Hamiltonian
46-vertex example \cite{tutte:on}.  Repeatedly replacing vertices of
this graph with copies of itself gives a family of graphs, $\langle G_i:i\in
\Z\rangle$ in which $G_i$ has $46\cdot 45^i$ vertices and circumference at
most $45\cdot44^i$.  Stated another way, $n$-vertex members of the
family have circumference $O(n^a)$, for $a=\log_{44}(45)) < n^{0.9941}$.
The current best upper bound of this type is due to Gr\"unbaum and
Walther \cite{grunbaum.walther:shortness} who construct a 24-vertex
non-Hamiltonian cubic 3-connected planar graph, resulting in a family
of graphs in which $n$-vertex members have circumference $O(n^{\alpha})$
for $\alpha=\log_{23}(22)< 0.9859$.

A series of results has steadily improved the lower bounds on the
circumference of $n$-vertex  (not necessarily planar) 3-connected cubic
graphs.  Barnette \cite{barnette:4} showed that, for every $n$-vertex
3-connected cubic graph $G$, $c(G)=\Omega(\log n)$.  Bondy and Simonovits
\cite{bondy.simonovits:7} improved this bound to $e^{\Omega(\sqrt{\log
n})}$ and conjectured that it can be improved to $\Omega(n^\alpha)$ for $\alpha>0$.
Jackson \cite{jackson:8} confirmed this bound with $\alpha=\log_2(1+\sqrt{5})-1
> 0.6942$.  Billinksi \etal\ \cite{billinksi.jacdson.ea:6} improved this
to the root of $4^{1/\alpha}-3^{1/\alpha}=2$, which implies $\alpha>0.7532$.  The current
record is held by Liu, Yu, and Zhang \cite{liu.yu.zhang:circumference}
who show that $\alpha>0.8$.  Together with \thmref{main}, this result implies
the following corollary:

\begin{cor}\corlabel{main}
  Every $n$-vertex triangulation of maximum degree $\Delta$ contains a
  collinear set of size $\Omega(n^{0.8}/\Delta^2)$.
\end{cor}

A longstanding open problem on circumference is \emph{Barnette's
Conjecture}, which asserts that every \emph{bipartite} 3-connected cubic
planar graph is Hamiltonian. Note that, if Barnette's conjecture is true,
this would imply that every triangulation in which every vertex has even
degree contains a collinear set of linear size.  \note{PM}{Think about
whether this even makes sense. For example, the assumption can only be
true when $n$ is odd.  Maybe there's a little trick we can do to make
it more generally applicable, like when only a small number, $k$, of
vertices have odd degree.}



\section{Proof of \thmref{main}}

Let $G$ be a plane graph.  We treat the vertices of $G$ as points,
the edges of $G$ as closed curves and the faces of $G$ as closed sets
(so that a face contains all the edges on its boundary and an edge
contains both its endpoints).  Whenever we consider subgraphs of $G$
we treat them as having the same embedding as $G$.  Similarly, if we
consider a graph $\bar{G}$ that is homeomorphic to $G$ then we assume
that the edges of $\bar{G}$---each of which repreesents a path in $G$
whose internal vertices all have degree 2---inherit their embedding from
the paths they represent in $G$.

Finally, if we consider the dual $G^*$ of $G$ then we treat it as a
plane graph in which each vertex $f$ is represented as a point in the
interior of the face $f$ of $G$ that it represents.  The edges of $G^*$
are embedded so that an edge $fg$ is contained in the union of the two
faces $f$ and $g$ of $G$, it intersects the interior of exactly one
edge of $G$ that is common to $f$ and $G$, and this intersection
consists of a single point.

A \emph{proper good curve} $C$ for a plane graph $G$ is a
Jordan curve with the following properties:
\begin{enumerate}
  \item proper: for any edge $xy$ of $G$, $C$ either contains $xy$, intersects
  $xy$ in a single point (possibly an endpoint), or is disjoint
  from $xy$; and
  \item good: $C$ contains at least one point in the interior of
  the outer face of $G$.
\end{enumerate}

Da Lozzo \etal\ show that proper good curves define collinear sets:

\begin{thm}\thmlabel{dalozzo}
  In a plane graph $G$, a set $S\subseteq V(G)$ is a collinear set if
  and only if there is a proper good curve for $G$ that contains $S$.
\end{thm}

For a triangulation $T$, let $v(T)$ denote the size of the largest
collinear set in $T$.  We will show that, for any triangulation $T$
of maximum degree $\Delta$
whose dual is $T^*$, $v(T)=\Theta(c(\dual{T})/\Delta^2)$ by demonstrating a
relationship between proper good curves in $T$ and cycles in $\dual{T}$.

In one direction, this result is easy, as used by Ravsky and Verbitsky
\cite{ravsky.verbitsky:on,ravsky.verbitsky:on-arxiv}.  If $T$ is a
triangulation that has a proper good curve $C$ containing $k$ vertices,
then a slight deformation of $C$ produces a proper good curve that
contains no vertices. This curve intersects a cyclic sequence of faces
$f_0,\ldots,f_{k'-1}$ of $T$ with $k'\ge k$.  In this sequence, $f_i$ and
$f_{(i+1)\bmod k'}$ share an edge, for every $i\in\{0,\ldots,k'-1\}$, so
this sequence is a closed walk in the dual $\dual{T}$ of $T$.  Property~1
of good curves and the fact that each face of $T$ is a triangle ensures
that $f_i\neq f_j$ for any $i\neq j$, so this sequence is a cycle in
$\dual{T}$ of length $k'\ge k$.  Therefore, $c(\dual{T})\ge v(T)$.

The other direction, lower-bounding $v(T)$ in terms $c(\dual{T})$
is more difficult. Not every cycle $C$ of length $\ell$ in $\dual{T}$
can be easily transformed into a proper good curve containing a similar
number of vertices in $C$.  In the next section, we describe three
parameters $\tau$, $\rho$, and $\kappa$ of a cycle $C$ in $\dual{T}$
and show that $C$ can always be transformed into a proper good curve
containing $\Omega(\kappa)$ vertices fo $T$.

\subsection{Faces that are Touched, Pinched, and Caressed}

We say that a cycle $C$ in a plane graph is non-trivial if it
is not contained in a single face of the graph.  Throughout the
remainder of this section, $T$ is a triangulation whose dual is
$\dual{T}$ and $C$ is a non-trivial cycle in $\dual{T}$.  Refer to
\figref{touched-pinched-caressed} for the following definitions.
We say that a face $f$ of $\dual{T}$ 
\begin{enumerate}
  \item is \emph{touched} by $C$ if $f\cap C\neq \emptyset$;
  \item is \emph{pinched} by $C$ if $f\cap C$ has more than one connected component; and
  \item is \emph{caressed} by $C$ if it is touched but not pinched by $C$.
\end{enumerate}

\begin{figure}
\begin{center}
	  \includegraphics{figs/tpc-2}
\end{center}
	  \caption{Faces of $T^*$ that are pinched and caressed by $C$. $C$ is bold, caressed faces are blue, pinched faces are pink, and untouched faces are unshaded.}
	  \figlabel{touched-pinched-caressed}
\end{figure}


Since $C$ is always the cycle of interest, we will say simply that a face
$f$ of $\dual{T}$ is touched, pinched, or caressed, without specifically
mentioning $C$.  We will frequently use the values $\tau$, $\rho$,
and $\kappa$ to denote the number of faces of $\dual{T}$ in some region
that are $\tau$ouched, $\rho$inched or $\kappa$aressed.  Observe that,
since every face that is touched is either pinched or caressed, we will
have the equation $\tau = \rho + \kappa$.

\begin{lem}\lemlabel{cycle-to-curve}
   If $C$ caresses $\kappa$ faces of $\dual{T}$ then $T$ has a proper
   good curve that contains at least $\kappa/4$ vertices so, by
   \thmref{dalozzo}, $v(T)\ge \kappa/4$.
\end{lem}

\begin{proof}
  Let $F$ be the set of faces in $\dual{T}$ that are caressed by $C$. Each
  element $u\in F$ corresponds to a vertex of $T$ so we will treat $F$
  as a set of vertices in $T$.  Consider the subgraph $T[F]$ of $T$
  induced by $F$.  The graph $T[F]$ is planar and has $k$ vertices. Therefore,
  by the 4-Colour Theorem \cite{seymour.ea:XX} $T[F]$ contains an independent
  set $F'\subset F$ of size at least $\kappa/4$.

  We claim that $T$ has a proper good curve that contains all the vertices
  in $F'$.  To see this, first observe that the cycle $C$ in $\dual{T}$
  already defines a proper good curve (that does not contain any vertices
  of $T$) that we will also call $C$.  We will perform surgery on $C$
  so that it contains all the vertices in $F'$.

  For each vertex $u\in F'$, let $w_0,\ldots,w_{d-1}$ denote the
  neighbours of $u$ in cyclic order.  The curve $C$ intersects some
  contiguous subsequence $uw_i,\ldots,uw_j$ of the edges adjacent
  to $u$.  Since $C$ is non-trivial, this sequence does not contain all
  edges incident to $u$. In particular, the curve $C$ crosses the edge
  $w_{i-1}w_i$, then crosses
  $uw_i,\ldots,uw_j$, and then crosses the edge $w_j w_{j+1}$.  We modify
  $C$ by removing the portion between the first and last of these crossings
  and replacing it with a curve that contains $u$ and is contained in the
  two triangles $w_{i-1}uw_i$ and $w_juw_{j+1}$. (See \figref{cycle-to-curve}.)

  \begin{figure}
     \begin{center}
	\begin{tabular}{cc}
		\includegraphics{figs/cycle-to-curve-1} &
		\includegraphics{figs/cycle-to-curve-2}
	\end{tabular}
     \end{center}
     \caption{Transforming the dual cycle $C$ into a proper good curve $C'$ containing $u$.}
	  \figlabel{cycle-to-curve}
  \end{figure}

  After performing this surgery for each $u\in F'$ we have a curve $C'$
  that contains every vertex $u\in F'$.  All that remains is verify that
  $C'$ is good and proper for $T$. That $C'$ is good for $T$ is
  obvious.  That $C'$ is proper for $T$ follows the following two observations:
  (i)~$C'$ does not contain any two adjacent vertices (since $F'$ is an
  independent set); and (ii)~if $C'$ contains a vertex $u$, then it does
  not intersect the interior of any edge incident to $u$.
\end{proof}

\lemref{cycle-to-curve} reduces our problem to finding a cycle in
$\dual{T}$ that caresses many faces.  We do this by showing that any
long cycle in $\dual{T}$ can be transformed into a cycle that caresses
many faces of $\dual{T}$.  It is tempting to hope that any sufficiently
long cycle in $\dual{T}$ caresses many faces, but this is not true;
\figref{few-caressed} shows that even a Hamiltonian cycle $C$ in $\dual{T}$
may caress only four faces, two inside $C$ and two outside of $C$.

\begin{figure}
   \begin{center}
       \includegraphics{figs/two-caressed}
   \end{center}
   \caption{A Hamiltonian cycle $C$ in $\dual{T}$ that caresses only four faces.}
   \figlabel{few-caressed}
\end{figure}

The following useful lemma shows that the example in \figref{few-caressed}
is tight.  A path $P$ in $\dual{T}$ is a \emph{chord path} (for $C$) if
both endpoints on $P$ are in $V(C)$ and none of $P$'s edges are in $E(C)$.

\begin{lem}\lemlabel{one-caressed}
   Let $P$ be a chord path for $C$ and let $L$ and $R$ be the two faces
   of $P\cup C$ that have $P$ on their boundary. Then each of $L$ and $R$
   contain at least one face of $\dual{T}$ that is caressed by $C$.
\end{lem}

\begin{proof}
   It suffices to consider $R$, since $L$ is symmetric.  The proof is by
   induction on the number, $t$, of faces of $\dual{T}$ contained in $R$.
   If $t=1$, then $R$ is a face of $\dual{T}$ and it is caressed by $C$.

   If $t>1$, then consider the face $f$ of $\dual{T}$ that is contained
	in $R$ and has the first edge of $P$ on its boundary.  Refer to \figref{one-caressed}. Since $t>1$,
   $X=R\setminus f$ is non-empty. The set $X$ may have several connected
   components $X_1,\ldots,X_k$, but each $X_i$ has a boundary that contains a chord path $P_i$ for $C$.
	We can therefore apply induction on $P_1$ (or any $P_i$).
  \begin{figure}
     \begin{center}
	\begin{tabular}{cc}
		\includegraphics{figs/one-caressed-1} &
		\includegraphics{figs/one-caressed-2}
	\end{tabular}
     \end{center}
	  \caption{The proof of \lemref{one-caressed}.}
	  \figlabel{one-caressed}
  \end{figure}
\end{proof}

Refer to \figref{auxilliary}. Consider the auxilliary
graph $H$ with vertex set $V(H)\subseteq V(\dual{T})$ and whose edge set
consist of the edges of $C$ plus those edges of $\dual{T}$ that belong
to any face pinched by $C$. Let $v_0,\ldots,v_{r-1}$ be the cyclic sequence of vertices on some face $f$ of $\dual{T}$ that is pinched by $C$.  
We identify two kinds of vertices that are \emph{special} with respect to $f$:
\begin{enumerate}
  \item A vertex $v_i$ is special of \emph{Type~A} if $v_{i-1}v_i$ is an edge of $C$ and $v_iv_{i+1}$ is not an edge of $C$.
  \item A vertex $v_i$ is special of \emph{Type~B} if $v_{i-1}v_i$ is not an edge of $C$ and $v_iv_{i+1}$ is an edge of $C$.
  \item A vertex $v_i$ is special of \emph{Type~Y} if $v_i$ not incident to any edge of $C$ and $v_i$ has degree 3 in $H$.
\end{enumerate}

  \begin{figure}
     \begin{center}\begin{tabular}{cc}
		\includegraphics[width=.45\textwidth]{figs/t0t1-2} &
		\includegraphics[width=.45\textwidth]{figs/t0t1-3} \\
                (a) & (b) \\[1em]
		\includegraphics[width=.45\textwidth]{figs/t0t1-4} & 
		\includegraphics[width=.45\textwidth]{figs/t0t1-5} \\
                (c) & (d)
     \end{tabular}\end{center}
	  \caption{(a)~the cycle $C$ in $\dual{T}$ with faces classified as pinched or caressed; (b)~the auxilliary graph $H$; (c)~the auxilliary graph $\tilde{H}$ with keeper paths highlighted; (d)~the trees $T_0$ and $T_1$.}
	  \figlabel{auxilliary}
  \end{figure}


We say that a path $v_i,\ldots,v_j$ is a \emph{keeper} with respect to
$f$ if $v_i$ is special of Type~A, $v_j$ is special of Type~B, and none
of $v_{i+1},\ldots,v_{j-1}$ are special.  We let $\tilde{H}$ denote the
subgraph of $H$ containing all the edges of $C$ and all the edges of
all paths that are special with respect to some face $f$ of $\dual{T}$.

It is worth remarking at this point that, by definition, every keeper
is contained in the boundary of at least one face $f$ of $\dual{T}$.
This property will be useful shortly.

Let $\bar{H}$ denote the graph that is homeormophic to $\tilde{H}$ but does not
contain any degree 2 vertices.  That is, $\bar{H}$ is the minor of $\tilde{H}$
obtained by repeatedly contracting an edge incident a degree-2 vertex.
The graph $\bar{H}$ naturally inherits an embedding from the embedding of $\tilde{H}$ (which inherits its embedding from an embedding $H$, which inherits an embedding from $\dual{T})$.  This embedding partitions the edges of $\bar{H}$ into three sets:
\begin{enumerate}
  \item The set $B$ of edges that are contained in (the embedding of) $C$;
  \item The set $E_0$ of edges whose interiors are contained in the interior of (the embedding of) $C$; and
  \item The set $E_1$ of edges whose interiors are contained in the exterior of (the embedding of) $C$.
\end{enumerate}

Observe that, for each $i\in\{0,1\}$, the graph $H_i$ whose edges are
exactly those in $B\cup E_i$ is outerplanar.  Let $T_i$ be the subgraph of
$\dual{H_i}$ whose edges are all those dual to the edges of $E_i$. From
the outerplanarity of $H_i$, it follows that $T_i$ is a tree. Note that
the nodes of $T_i$, which are faces of $\bar{H}$, are subsets of the
plane obtained by taking the closure of the union of faces in $\dual{T}$.
In the following, when we say that a node $u$ of $T_i$ contains a face
$f$ of $\dual{T}$ we mean that $f$ is one of the faces of $\dual{T}$
whose union makes up $u$.


The following lemma allows us to direct our effort towards proving that
one of $T_0$ or $T_1$ has many leaves.

\begin{lem}\lemlabel{one-caressed-leaf}
   Each leaf $u$ of $T_i$ contains at least one face of $\dual{T}$
   that is caressed by $C$.
\end{lem}

\begin{proof}
   The edge of $T_i$ incident to $u$ corresponds to a chord path $P$. The
   graph $P\cup C$ has two faces with $P$ on its boundary, one of which
   is $u$.  The lemma now follows immediately from \lemref{one-caressed}.
\end{proof}


\begin{lem}\lemlabel{many-caressed-or-high-degree}
   Let $u$ be a node of $T_i$ and let $\rho_u$, $\kappa_u$, and $\delta_u$ denote the number of pinched faces of $\dual{T}$ in $u$, the number of caressed faces of $\dual{T}$ in $u$, and the degree of $u$ in $T_i$, respectively.  Then $\rho_u \le 2(\kappa_u+\delta_u)$.
\end{lem}

\begin{proof}
   The proof is a discharging argument.  We assign each pinched face of
   $u$ a single unit of charge, so that the total charge is $\rho_u$.
   We then describe a set of discharging rules that preserve the total
   charge.  After the application of these rules, pinched faces in $u$
   have no charge, each caressed face in $u$ has charge at most 2,
   and each keeper path in $u$ has charge at most 2.  Since there is a
   bijection between keeper paths in $u$ and edges of $T_i$ incident to
   $u$, this proves the result.

   We now describe the discharging rules, which are recursive and take as
   input a chord path $P$ that partitions $u$ into two parts $L$ and $R$.
   We require as a precondition that there are $k\ge 1$ pinched faces
   of $T^*$ in $L$, each of which contains at least one edge of $P$ and
   such that every edge of $P$ is contained in at one of these faces.
   During a recursive call, $P$ may have a charge $c\in\{0,1,2\}$. This
   charge should be at most 1 if $k\ge 1$, but can be 2 if $k=1$.

   To initialize the discharging procedure, we choose an arbitrary pinched
   face $f$ contained in $u$.  The face $f$ contains several chord paths
   $P_1,\ldots,P_r$, $r\ge 2$.  We move the charge from $f$ onto $P_1$
   and apply the recursive procedure to $P_1$, with a charge of 1 (with
   $L$ being the part of $u\setminus P_1$ that contains $f$).  We then
   recursively apply the discharging procedure on each of $P_2,\ldots,P_r$
   with a charge of 0.

   Next we describe each recursive step, during which we are given $P$
   with some charge $c\in\{0,1,2\}$.  There are several cases to consider
   (see \figref{discharging}):
	\begin{figure}
		\begin{center}
		\begin{tabular}{cc}
			\includegraphics{figs/discharge-2} &
			\includegraphics{figs/discharge-3} \\
			 2.a & 2.b \\[1.5em]
			\includegraphics{figs/discharge-4} &
			\includegraphics{figs/discharge-5} \\
			 2.c & 3 
		\end{tabular}
		\end{center}
		\caption{Discharging steps in the proof of \lemref{many-caressed-or-high-degree}.}
		\figlabel{discharging}
	\end{figure}
  \begin{enumerate}
     \item $R$ contains no face of $\dual{T}$ that is pinched by $C$.
     This could occur if $R$ is empty, because $P$ is a keeper path,
     in which case we leave a charge of $c$ on it and we are done.
     Otherwise $R$ is non-empty and \lemref{one-caressed}  ensures that
     $R$ contains at least one caressed face $f$.  We move the charge
     from $P$ onto $f$ and we are done.

     \item $R$ contains a face $f$ that is pinched by $C$ and that shares
     at lest one edge with $P$.  We consider three subcases:
     \begin{enumerate}
        \item $f$ contains neither endpoint of $P$. In this case,
        $R\setminus f$ has at least three connected components, $A$,
        $B$, and $X_1,\ldots,X_k$, where $A$ and $B$ each contain an
        endpoint of $P$ and each $X_i$ has a chord path $P_i$ path in
        common with $f$.  We recurse on each of these components so
        that each of these components takes the place of $R$ in the
        recursion. When recursing on $A$ we take one unit of charge
        from $P$ (if needed).  When recursing on $B$ we take the second
        unit of charge from $P$ (if needed).  When recursing on $X_1$ we
        take the unit of charge from $f$. When recursing on $X_2,\ldots,X_k$
        we use no additional charge.

	\item $f$ contains exactly one endpoint of $P$.  In this case,
	$u\setminus f$ has one connected component $A$ that contains an
	endpoint of $P$, one or more connected components $X_1,\ldots,X_k$
	where each $X_i$ has a chord path $P_i$ on the boundary of $f$.

	The path $P$ has a charge $c\le 2$.  When recursing on $X_1$ we
	assign all of $P$'s charge to the chord path $P_1$, which is contained
        in the single pinched face $f$.
		     
	When recursing on $A$ we assign move the single unit of charge
	from $f$ to the chord path of $A$.

        \item $f$ contains both endpoints of $P$.  In this case, $P$ must
        be on the boundary of more than one pinched faces in $L$, otherwise $P$
        would be a keeper path. Therefore $P$
        has at most one unit of charge assigned to it.  Now, $R\setminus
        f$ has one or more connected components $X_1,\ldots,X_k$ sharing
        chord paths $P_1,\ldots,P_k$ with $f$ on which we recurse.
        When recursing on $X_1$ we move the charge from $P$ and the
        charge from $f$ to $P_1$.  When recursing on the remaining $X_i$,
        $i\in\{2,\ldots,k\}$ we assign no charge to $P_i$.
  \end{enumerate}
  \item $R$ contains at least one pinched face, but no pinched face in $R$
  shares an edge with $P$.  In this case, consider the face $g$ of $H$
  that is contained in $R$ and has $P$ on its boundary. By definition,
  $g$ contains no bad faces of $\dual{T}$, but $g$ is touched by $C$,
  so $g$ contains at least one good face\footnote{In fact $g$ contains at
  least two good faces, one for each endpoint of $P$.} $f$ of $\dual{T}$.
  We move the $c$ units of charge from $P$ onto $f$.

  Now, $R$ still contains one or more pinched faces
  $f_1,\ldots,f_k$, where each $f_i$ shares a chord path $P_i$ with $g$.
  On each such face $f_i$, we run the initialization procedure described
  above except that we recurse only on the chord paths of $f_i$ that
  do not share edges with $g$. i.e., we do not recurse on the chord
  path $P_i$.
\end{enumerate}
   This completes the description of the discharging procedure, and the proof.
\end{proof}

\note{PM}{The leading constant 2 in \lemref{many-caressed-or-high-degree}
is essentially tight. Make a figure to show this.}

The following lemma says that if $C$ touches many faces then it must caress many faces, or $T_0$ and $T_1$ must have many degree-2 nodes.

\begin{lem}\lemlabel{many-caressed-or-many-degree-2}
  Let $\tau$, $\rho$, and $\kappa$ denote the number of nodes touched,
  pinched, and caressed by $C$, respectively and let $m_2$ denote the
  total degree of degree-2 nodes in $T_0$ and $T_1$.  Then $11\kappa +
  4m_2 \ge \tau$.
\end{lem}

\begin{proof}
  Since every face of $\dual{T}$ touched by $C$ is either pinched or
  caressed, for any node $u$ of $T_0$ or $T_1$, we have
  \begin{equation}
       \kappa_u + \rho_u = \tau_u \enspace . \eqlabel{tpc}
  \end{equation}
  From \lemref{many-caressed-or-high-degree}, we have 
  \[
      2(\kappa_u+\delta_u) \ge \rho_u \enspace .
  \]
  Combining the preceding equations and summing over all $u$ in $T_0$
  and $T_1$, we ge
  \begin{equation}
       3\kappa + 2\delta \ge \tau \enspace . \eqlabel{tpc-a}
  \end{equation}
  The total number of edges in $T_0$
  and $T_1$ is $\delta/2$ and therefore the total number, $m$,
  of nodes in $T_0$ and $T_1$ is $\delta/2+1$. Using the inequality
  $2m\ge \delta$ in \eqref{tpc-a} we obtain 
  \begin{equation}
       3\kappa + 4m \ge \tau \enspace .  \eqlabel{tpc-b}
  \end{equation}
  The number, $m_{\ge 3}$ of nodes of degree at least three in $T_0$
  and $T_1$ is less than the number, $m_1$, of leaves.  Therefore,
  the number $m_2$ of degree 2 nodes is at least
  \[
     m_2 = m - m_1 - m_{\ge 3} \ge m-2m_1 \enspace .
  \]
  Using the inequality $m\le m_2+2m_1$  in \eqref{tpc-b}, we obtain:
  \begin{equation}
       3\kappa + 4(m_2+2m_1) \ge \tau \enspace .  \eqlabel{tpc-c}
  \end{equation}
  By \lemref{one-caressed}, each leaf contains at least one face caressed
  by $C$, so $\kappa \ge m_1$. Using this inequality in \eqref{tpc-c}
  we obtain
  \begin{equation}
       3\kappa + 4(m_2+2\kappa) \ge \tau \enspace .  \eqlabel{tpc-d}
  \end{equation}
  which simplifies to $11\kappa + 4m_2 \ge \tau$, as required.
\end{proof}

\subsection{Bad Nodes}

From \lemref{many-caressed-or-many-degree-2} we know that $C$ either
caresses $\tau/22=\Omega(\tau)$ faces, or the total number of degree-2
nodes in $T_0$ and $T_1$ is at least $\tau/8=\Omega(\tau)$.  This helps
understand the example in \figref{few-caressed}, in which $C$ caresses
only 4 faces and each of $T_0$ and $T_1$ is a path, so nearly all their
nodes are degree-2. \note{PM}{\lemref{many-caressed-or-many-degree-2} is only ever used in this paragraph. Delete it?}

\begin{lem}\lemlabel{few-caressed-implies-many-nodes}
  Let $\tau_i$, $\rho_i$, and $\kappa_i$ denote the number of faces
  in $\dual{T}$ contained in nodes of $T_i$ that are touched, pinched,
  and caressed by $C$ and let $n_i$ denote the number of nodes of $T_i$.
  If $\kappa_i < \tau_i/6$ then $n_i\ge \tau_i/8$.
\end{lem}

\begin{proof}
  Let $\delta_i=2(n_i-1)$ denote the total degree of nodes in $T_i$.
  Recall the identity $\tau_i = \rho_i+\kappa_i$ and the inequality,
  from \lemref{many-caressed-or-high-degree}, $2(\kappa_i+\delta_i)
  \ge \tau_i$. Combining these two, we obtain:
  \[
  \tau_i 
     \le 3\kappa_i + 2\delta_i 
     = 3\kappa_i + 4(n_i-1) 
     \le \tau_i/2 + 4n_i \enspace ,
  \]
  and reorganizing the terms gives the desired result.
\end{proof}

We say that a node of $T_i$ is \emph{bad} if it has degree-2 and contains
no face of $\dual{T}$ that is caressed by $C$.

\begin{lem}\lemlabel{most-nodes-are-bad}
   Let $n_i$ and $b_i$ denote the number of nodes and bad nodes in
   $T_i$. For any $0<\epsilon < 1$, if $b_i \le (1-\epsilon)n_i$, then
   $\kappa_i = \Omega(\epsilon\tau_i)$.
\end{lem}

\begin{proof}
   Partition the nodes of $T_i$ into the following sets:
   \begin{enumerate}
       \item the set $B$ of bad nodes;
       \item the set $N_1$ of leaves;
       \item the set $N_{\ge 3}$ of nodes having degree at least 3;
       \item the set $N_2$ of nodes having degree 2 that are not bad.
   \end{enumerate}
   \begin{align*}
     b_i & = n_i - |N_1|- |N_{\ge 3}|-|N_2| \\
         & \ge  n_i - \kappa_i - |N_{\ge 3}|-|N_2| 
           & \text{(by \lemref{one-caressed-leaf})} \\
          & >  n_i - 2\kappa_i -|N_2| 
           & \text{(since $N_{\ge 3} < N_1$)} \\
           & >  n_i - 3\kappa_i -|N_2| 
           & \text{(since each node in $N_2$ contains a caressed face)}
    \end{align*}
    Thus, we have
    \[
          n_i-3\kappa_i \le b_i \le (1-\epsilon)n_i
    \]
    and rewriting gives 
    \begin{equation}
      \kappa_i \ge \epsilon n_i/3 \enspace . \eqlabel{blech}
    \end{equation}
    If $\kappa_i \ge \tau_i/6$, then the proof is complete.  On the other hand, if $\kappa_i \le \tau_i/6$ then, by \lemref{few-caressed-implies-many-nodes}, $n_i \ge \tau_i/8$. Combining this with \eqref{blech}  gives
    \[
      \kappa_i \ge \epsilon\tau_i/24 = \Omega(\epsilon \tau_i) \enspace .
    \]
\end{proof}

\subsection{Interaction Between Bad Nodes}

We have now reached a point in which we know that the vast
majority of nodes in $T_0$ and $T_1$ are bad nodes, otherwise
\lemref{most-nodes-are-bad} implies that a constant fraction of the
faces touched by $C$ are caressed by $C$.  At this point, we are ready
to study interactions between bad nodes of $T_0$ and bad nodes of $T_1$.


\begin{lem}\lemlabel{common-face}
   If $u$ is a bad node then there is a single face $f$ of $\dual{T}$
   that is contained in $u$ and that contains all edges of $C\cap u$.
\end{lem}

\begin{proof}
   First observe that, since $u$ has degree-2, $C\cap u$ has exactly
   two connected components $C_1$ and and $C_2$. Thus $u$'s boundary
   consists of $C_1$, $C_2$ and two chord paths $P_1$ and $P_2$.

   Suppose some path $P$ with endpoints on the boundary of $u$ and
   internal vertices contained in $u$ separates two edges of $E(C)$
   on the boundary of $u$.  There are a few cases to rule out:
   \begin{enumerate}
       \item $P$ has both endpoints on $C_i$ for some $i\in\{1,2\}$. In
       this case, $P$ is a chord path and, by \lemref{one-caressed}
       $u$ contains a face that is caressed by $C$, contradicting the
       assumption that $u$ is a bad node.

       \item $P$ has one endpoint on $C_i$ and one endpoint on $P_j$
       for some $i,j\in\{1,2\}$.  In this case, $P\cup P_j$ contains a
       chord path with both endpoints on $C_i$, again contradicting the
       assumption that $u$ is a bad node.

       \item $P$ has one endpoint on $P_1$ and one endpoint on $P_2$.
       In this case, $P\cup P_1\cup P_2$ contains a chord path with both
       endpoints in $C_1$, again contradicting the assumption that $u$
       is a bad node.

       \item $P$ has one endpoint on $C_1$ and one endpoint on $C_2$.
       The path $P$ is not a keeper, otherwise it would have split $u$
       into two nodes.  Therefore, it must be the case that $P$ contains
       an internal vertex $w$. Since $\dual{T}$ is 3-regular, $w$ has
       degree 3.  Again, the third edge incident to $w$ implies the
       existence of a chord path with both endpoints on $C_i$, for some
       $i\in\{1,2\}$, contradicting the assumption that $u$ is a bad node.
\end{enumerate}
\end{proof}

We are interested in working with bad nodes of $T_0$ and $T_1$ and how
these nodes interact.  The following lemma shows that a bad node $u$ in $T_0$
and a bad node $w$ in $T_1$ share at most one edge of $C$.

\begin{lem}\lemlabel{one-shared-edge}
   If $u$ and $w$ are bad nodes that share at least one edge of $C$, then
   $u$ and $w$ share exactly one edge of $C$.
\end{lem}

\begin{proof}
   Suppose $u$ and $w$ share two edges $e_1$ and $e_2$ of $C$.  Then, by
   \lemref{common-face}, there is a common face $f_u$ in $u$ that contains
   $e_1$ and $e_2$, Similarly, there is a common face $f_w$ contained
   in $w$ that contains both $e_1$ and $e_2$.  This means that $e_1$ and
   $e_2$ form an edge cutset of $\dual{T}$.  If $\dual{T}$ has at least
   five vertices, then this implies that $\dual{T}$ has a vertex cutset
   of size 2.  This is not possible because $\dual{T}$ is 3-connected.
\end{proof}



\subsection{Really Bad Nodes}


At this point we will start making use of the assumption that the
triangulation $T$ has maximum degree $\Delta$, which is equivalent to
the assumption that the faces of $\dual{T}$ have at most $\Delta$ edges
on their boundary.

\begin{obs}\obslabel{degree-touched}
  If $T$ has maximum degree $\Delta$ and $C$ has length $\ell$, then
  the number of faces $\tau$ of $\dual{T}$ touched by $C$ is at least $\ge
  2\ell/(\Delta-1)$.  At least $\ell/(\Delta-1)$ of these faces are in
  the interior of $C$ and at least $\ell/(\Delta-1)$ of these faces are
  in the exterior of $C$.
\end{obs}

\begin{proof}
  Orient the edges of $C$ counterclockwise so that, for each edge
  $e$ of $C$, the face of $\dual{T}$ to the left of $e$ is in $C$'s
  interior and the face of $\dual{T}$ to the right of $e$ is in $C$'s
  exterior.  Each face of $\dual{T}$ has at most $\Delta$ edges and,
  since $C$ is non-trivial, $C$ contains at most $\Delta-1$ edges of any
  face. Therefore, the number of faces to the right of edges in $C$ is
  at least $\ell/(\Delta-1)$. The same is true for the number of faces
  of $\dual{T}$ to the left of edges in $C$.
\end{proof}

For a node $u$ of $T_i$, we define $N(u)$ as the set of nodes (in $T_0$
and $T_1$) that share an edge of $\dual{T}$ with $u$.  We say that a
node $u$ is \emph{really bad} if $u$ and all nodes in $N(u)$ are bad.

\begin{lem}\lemlabel{lots-of-really-bad}
  For every sufficiently small $0<\alpha < 1/2$,  
  if $T$ has maximum degree $\Delta$, $C$ has length $\ell$, and the number
  $\kappa$, of faces caressed by $C$ is at most $\alpha\ell/\Delta^2$, then
  the number of really bad nodes in $T_0$ is at least $n_0-O(\alpha n_0)$.
\end{lem}

\begin{proof}
  Define $\tau_i$, $\kappa_i$, ....

  First consider the tree $T_0$.  From \obsref{degree-touched},
  we know that $\tau_0\ge \ell/\Delta$.  By assumption,
  $\kappa_0\le\kappa\le \alpha\ell/\Delta \le \tau_0/6$
  so, by \lemref{few-caressed-implies-many-nodes}, $n_0 \ge
  \tau_0/8=\Omega(\ell/\Delta)$.
  
  Let $\epsilon=a\alpha/\Delta$ for some $a>0$ to be discussed shortly.
  By \lemref{most-nodes-are-bad}, if $b_0 < (1-\epsilon) n_0$, then
  \[ 
      \kappa \ge \kappa_0 = \Omega(\epsilon\tau_0)
               = \Omega(\epsilon\ell/\Delta)
               = \Omega(a\alpha\ell/\Delta^2) 
               \enspace .
  \]
  For sufficiently large, constant, $a$ this violates our assumption
  that $\kappa \le \alpha\ell/\Delta^2$.
  Therefore, we may assume that $b_0\ge (1-\epsilon)n_0$, i.e., most nodes
  of $T_0$ are bad.

  We now want to study how many of the bad nodes in $T_0$ are really bad.
  Each node $w$ of $T_0$ is in $N(u)$ for at most $\delta_w$ bad nodes
  $u$ in $T_0$.  Let $A$ be the set of nodes in $T_0$ that are not
  bad and partition $A$ into $A_1$ (leaves), $A_2$ (degree-2 nodes)
  and $A_{\ge 3}$ (nodes of degree at least 3).  We make use of the
  following inequality:
  \[  |A_1| = 2 + \sum_{w\in A_3}(\delta_w-2) \ge \sum_{w\in A_3}(\delta_w-2)
    \ge \sum_{w\in A_3}3\delta_w \enspace , \] 
  which is true because $x-2>x/3$ for all $x\ge 3$. 
  Now we have 
  \begin{align*}
   \sum_{w\in A}\delta_w 
    & = \sum_{w\in A_1}\delta_w 
         + \sum_{w\in A_2}\delta_w 
         + \sum_{w\in A_{\ge 3}}\delta_w \\
    & \le |A_1| + 2|A_2| + 3|A_1| \\
    & \le 6\kappa & \text{(since $\kappa_w\ge 1$ for each $w\in A_1\cup A_2$)}\\
    & \le 6\alpha\ell/\Delta^2 & \text{(by assumption)}\\
    & = O(\alpha n_0/\Delta) & \text{(since $n_0=\Omega(\ell/\Delta)$)}\enspace .
  \end{align*}
  That is, the set of non-bad nodes in $T_0$ prevents at most $O(\alpha
  n_0/\Delta)$ bad nodes of $T_0$ from being really bad. Next we account
  for how nodes in $T_1$ prevent bad nodes in $T_0$ from being really bad.

  Let $A'$ be the set of non-bad nodes in $T_1$.  For two
  nodes $u$ in $T_0$ and $w$ in $T_1$,  $w\in N(u)$ if and only if $w$
  and $u$ share an edge of $C$.  The number of edges of $C$ incident to a node $w$ is at most $(\Delta-1)\tau_w < \Delta\tau_w$.  Therefore, we can upper bound the number of bad nodes in $T_0$ that are prevented from being really bad by some node in $T_1$ as
  \begin{align*}
   \sum_{w\in A'}\Delta \tau_w  
    & \le  \sum_{w\in A'}2\Delta(\kappa_w + \delta_w) & \text{(by \lemref{many-caressed-or-high-degree})} \\
    & \le  2\Delta\kappa + \sum_{w\in A'}2\Delta\delta_w \\
    & < 2\Delta\kappa + 12\Delta\kappa & \text{(by the same argument as above)}\\
    & = 14\Delta\kappa \\
    & \le 14\alpha\ell/\Delta & \text{(by assumption)}\\
    & = O(\alpha n_0) & \text{(since $n_0=\Omega(\ell/\Delta)$)}
  \end{align*}
  Therefore, the number of bad nodes in $T_0$ is at least
  $(1-\epsilon)n_0$ and the number of these that are really bad is
  at least $(1-\epsilon)n_0 - O(\alpha n_0) = n_0-O(\alpha n_0)$,
  as required.
\end{proof}


\subsection{Tree/Cycle Surgery}

At this point we are ready to complete the proof of \thmref{main}.
By \lemref{cycle-to-curve}, it suffices to prove the existence of a
cycle $C$ in $\dual{T}$ that caresses $\Omega(\ell/\Delta^3)$ faces.
We begin by applying \lemref{lots-of-really-bad} with $\alpha =
\epsilon/\Delta$.  If $\epsilon$ is a sufficiently small constant, then
\lemref{lots-of-really-bad} implies that $\kappa = \Omega(\ell/\Delta^3)$
or the number of nodes in $T_0$ that are not really bad is at most
$O(n_0/\Delta)$.  In the former case, $C$ caresses $\Omega(\ell/\Delta^3)$
faces of $\dual{T}$ and we are done.

In the latter case, consider the subgraph of $T_0$ obtained by
removing all nodes of $T_0$ that are not really bad.  This subgraph has
$O(\epsilon n_0)$ components, each of which is a path.  At least one of
these components contains at least $O(1/\epsilon)$ nodes. In particular,
for a sufficiently small constant $\epsilon$, one of these components,
$X$ has at least $100\Delta+2$ nodes.

Let $N(X)=\bigcup_{u\in V(X)} N(u)$.  And observe that
$T_1[N(X)]$ consists of two paths $Y_1$ and $Y_2$ of bad nodes.
By \lemref{one-shared-edge}, each node in $X$ shares at most one edge
with each node in $Y_1$ or $Y_2$.  Each node $u$ in $X$ shares an edge
with at least one node in each of $Y_1$ and $Y_2$.  Since $\dual{T}$
is 3-regular, $T$ has maximum degree $\Delta$ and $X$ has length
$100\Delta+2$, there must exist some node $u$ in the interior of $X$
such that $N(u)$ consists of at least 5 nodes (refer to \figref{surgery}):
\begin{enumerate}
   \item neighbours $x$ and $y$ of $u$ in $T_0$;
   \item a subpath $a_1,\ldots,a_r$ of $Y_1$, with $r\ge 2$; and
   \item a subpath $b_1,\ldots,b_s$ of $Y_2$, with $s\ge 1$ \enspace .
\end{enumerate}
We use the convention that $a_1,b_1\in N(x)$, $a_r,b_s\in N(y)$. We
also name 4 other nodes of $T_1$: (i)~$a_0$ adjacent to $a_1$;
(ii)~$a_{r+1}$ adjacent to $a_r$; (iii)~$b_0$ adjacent to $b_1$; and
(iv)~$b_{s+1}$ adjacent to $b_s$.

At this time it is helpful to think of $T_0$, $T_1$, and $C$ as a
partition of $\R^2$, where nodes of $T_0$ are coloured red, nodes of $T_1$
are coloured blue and $C$ is the (purple) boundary between red and blue.
To describe our modifications of $C$, we imagine changing the colours
of nodes.  The effect such a recolouring has on $T_0$ or $T_1$ may not
be immediately obvious, but the effect on $C$ is clear: $C$ contains
every edge contained in the red-blue boundary.

\begin{enumerate}
   \item The path in $T_1$ from $a_1$ to $b_1$ contains $a_2$.
     In this case, removing $a_1$ from $T_1$ partitions $T_1$ into two
     components, one of which contains $a_r$ and the other of which
     contains $b_1$.

     In this case we move $a_1$ to $T_0$ and $u$ to $T_1$.  Moving $u$
     to $T_1$ restores a path from $a_r$ to $b_1$.  Moving $a_1$ to $T_0$
     restores the path from $y$ to $x$.

   \item The path in $T_1$ from $a_1$ to $b_1$ does not contain $a_2$.
     In this case, removing $a_r$ from $T_1$ partitions $T_1$ into two
     components, one containing $a_1$ and one containing $b_1$.

     In this case we move $a_r$ to $T_0$ and $u$ to $T_1$. The addition fo
     $u$ to $T_1$ restores the path from $a_1$ to $b_1$ and the addition
     of $a_r$ to $T_0$ restores the path from $x$ to $y$.
\end{enumerate}

It is clear what this operation does to the cycle $C$.  What does
this operation do to the trees $T_0$ and $T_1$?  We claim that this
operation increases the number of leaves in each of $T_0$ and $T_1$.
Specifically, we claim that the faces of $u$ become part of a node $u'$
in $T_1$ that has degree 3.

In Case~1, the node containing $y$ in $T_0$ has become a leaf, so
the number of leaves in $T_0$ has increased.  From the node of $T_1$
containing $u$ there are three disjoint path, one leading to $b_0$,
one leading to $b_{s+1}$, and one leading to $a_{r+1}$.  Therefore,
the number of nodes of degree at least three, and hence of the number
of leaves, in $T_1$ has also increased.

In Case~2, the node containing $x$ in $T_0$ has become a leaf.  From the
node containing $u$ in $T_1$, there are three disjoint paths from $u$
to $b_0$, from $u$ to $b_{r+1}$ and from $u$ to $a_1$.  Therefore,
the number of nodes of degree at least 3 has increased in $T_1$.

This operation changes the length of the cycle $C$ by at most $\Delta$
(the only edges lost from $C$ are on the boundary of $u$ and therefore,
by \lemref{common-face} all contained in a single face.

Therefore, if we start with a cycle $C$ of length $\ell$, then we can
perform this operation at least $\ell/(2\Delta)$ times before the length
of $C$ decreases to less than $\ell'=\ell/2$. If at some point during
this process, we are no longer able to perform this operation, it is because $C$ caresses $\Omega(\ell'/\Delta^3)=\Omega(\ell/\Delta^3)$ faces of $\dual{T}$ and we are done.  By the end of this process, the number of leaves in $T_0$ is at least $\ell/2\Delta\in\Omega(\ell/\Delta)\subset\Omega(\ell/\Delta^3)$ and we are also done.  This completes the proof of \thmref{main}.

\note{PM}{There's an annoying lopsidedness here. Is there a less brutal way to find the node $u$ we need? All we really need to do this operation is a really bad node (in $T_0$ or $T_1$) of degree at least 5.}



\bibliographystyle{plain}
\bibliography{collsets}

\end{document}









